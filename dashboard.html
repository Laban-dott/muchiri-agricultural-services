<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Driver Dashboard - Muchiri Services</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Login Page -->
    <div id="loginPage" class="page">
        <div class="login-container">
            <div class="login-header">
                <h1>üöú Driver Login</h1>
                <p>Access your service dashboard</p>
            </div>
            
            <form id="loginForm" class="login-form">
                <div class="input-group">
                    <input type="text" id="username" placeholder="Username" required>
                </div>
                <div class="input-group">
                    <input type="password" id="password" placeholder="Password" required>
                </div>
                <button type="submit" class="login-btn">Login</button>
            </form>
            
            <div class="login-footer">
                <button onclick="goHome()" class="back-home-btn">‚Üê Back to Home</button>
            </div>
        </div>
    </div>

    <!-- Dashboard Page -->
    <div id="dashboardPage" class="page hidden">
        <div class="dashboard-container">
            <!-- Header -->
            <header class="dashboard-header">
                <div class="header-content">
                    <h1>Driver Dashboard</h1>
                    <button onclick="logout()" class="logout-btn">Logout</button>
                </div>
                <div class="stats-summary">
                    <div class="stat-item">
                        <span class="stat-number" id="totalBookings">0</span>
                        <span class="stat-label">Total Bookings</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="completedBookings">0</span>
                        <span class="stat-label">Completed</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="pendingBookings">0</span>
                        <span class="stat-label">Pending</span>
                    </div>
                </div>
            </header>

            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="tab-btn active" onclick="showTab('pending')">
                    Pending <span id="pendingCount" class="count-badge">0</span>
                </button>
                <button class="tab-btn" onclick="showTab('completed')">
                    Completed <span id="completedCount" class="count-badge">0</span>
                </button>
                <button class="tab-btn" onclick="showTab('all')">
                    All Bookings <span id="allCount" class="count-badge">0</span>
                </button>
            </div>

            <!-- Bookings Content -->
            <div class="bookings-content">
                <!-- Pending Bookings -->
                <div id="pendingTab" class="tab-content active">
                    <div class="section-header">
                        <h2>üìã Pending Services</h2>
                        <button onclick="refreshBookings()" class="refresh-btn">üîÑ Refresh</button>
                    </div>
                    <div id="pendingBookings" class="bookings-list">
                        <!-- Pending bookings will be loaded here -->
                    </div>
                </div>

                <!-- Completed Bookings -->
                <div id="completedTab" class="tab-content">
                    <div class="section-header">
                        <h2>‚úÖ Completed Services</h2>
                        <button onclick="refreshBookings()" class="refresh-btn">üîÑ Refresh</button>
                    </div>
                    <div id="completedBookings" class="bookings-list">
                        <!-- Completed bookings will be loaded here -->
                    </div>
                </div>

                <!-- All Bookings -->
                <div id="allTab" class="tab-content">
                    <div class="section-header">
                        <h2>üìä All Services</h2>
                        <button onclick="refreshBookings()" class="refresh-btn">üîÑ Refresh</button>
                    </div>
                    <div id="allBookings" class="bookings-list">
                        <!-- All bookings will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample data - In real application, this would come from a database
        let bookingsData = [
            {
                id: 1,
                service: 'Rotavation',
                customer: 'John Kamau',
                phone: '0712345678',
                section: 'Kraba',
                unit: 'K1',
                quantity: '2 acres',
                date: '2025-08-29',
                amount: 'KSH 10,000',
                status: 'pending',
                createdAt: '2025-08-28'
            },
            {
                id: 2,
                service: 'Transport',
                customer: 'Mary Wanjiku',
                phone: '0723456789',
                section: 'Tebere',
                unit: 'T2',
                quantity: '50 bags',
                date: '2025-08-30',
                amount: 'KSH 7,500',
                status: 'pending',
                createdAt: '2025-08-28'
            },
            {
                id: 3,
                service: 'Harvesting',
                customer: 'Peter Maina',
                phone: '0734567890',
                section: 'Wamunu',
                unit: 'W3',
                quantity: '1 acre',
                date: '2025-08-27',
                amount: 'KSH 6,000',
                status: 'completed',
                createdAt: '2025-08-26'
            }
        ];

        // Login functionality
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            // Simple authentication (in real app, use proper authentication)
            if (username === 'muchiri' && password === '54321') {
                showPage('dashboardPage');
                loadDashboard();
            } else {
                alert('Invalid username or password');
            }
        });

        // Page navigation
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
            });
            document.getElementById(pageId).classList.remove('hidden');
        }

        function goHome() {
            window.location.href = 'home.html';
        }

        function logout() {
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            showPage('loginPage');
        }

        // Tab functionality
        function showTab(tabName) {
            // Remove active from all tabs
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Add active to selected tab
            event.target.classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');
        }

        // Load dashboard data
        function loadDashboard() {
            updateStats();
            renderBookings();
        }

        function updateStats() {
            const total = bookingsData.length;
            const completed = bookingsData.filter(b => b.status === 'completed').length;
            const pending = bookingsData.filter(b => b.status === 'pending').length;
            
            document.getElementById('totalBookings').textContent = total;
            document.getElementById('completedBookings').textContent = completed;
            document.getElementById('pendingBookings').textContent = pending;
            
            document.getElementById('pendingCount').textContent = pending;
            document.getElementById('completedCount').textContent = completed;
            document.getElementById('allCount').textContent = total;
        }

        function renderBookings() {
            const pendingBookings = bookingsData.filter(b => b.status === 'pending');
            const completedBookings = bookingsData.filter(b => b.status === 'completed');
            
            renderBookingsList('pendingBookings', pendingBookings);
            renderBookingsList('completedBookings', completedBookings);
            renderBookingsList('allBookings', bookingsData);
        }

        function renderBookingsList(containerId, bookings) {
            const container = document.getElementById(containerId);
            
            if (bookings.length === 0) {
                container.innerHTML = `
                    <div class="no-bookings">
                        <div class="no-bookings-icon">üìù</div>
                        <p>No bookings found</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = bookings.map(booking => `
                <div class="booking-card ${booking.status}">
                    <div class="booking-header">
                        <div class="service-info">
                            <h3>${getServiceIcon(booking.service)} ${booking.service}</h3>
                            <span class="status-badge ${booking.status}">${booking.status.toUpperCase()}</span>
                        </div>
                        <div class="booking-amount">${booking.amount}</div>
                    </div>
                    
                    <div class="customer-info">
                        <div class="info-row">
                            <span class="label">Customer:</span>
                            <span class="value">${booking.customer}</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Phone:</span>
                            <span class="value">${booking.phone}</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Location:</span>
                            <span class="value">${booking.section} - ${booking.unit}</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Quantity:</span>
                            <span class="value">${booking.quantity}</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Date:</span>
                            <span class="value">${formatDate(booking.date)}</span>
                        </div>
                    </div>
                    
                    ${booking.status === 'pending' ? `
                        <div class="booking-actions">
                            <button onclick="markCompleted(${booking.id})" class="complete-btn">
                                ‚úÖ Mark Complete
                            </button>
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        function getServiceIcon(service) {
            switch (service) {
                case 'Rotavation': return 'üöú';
                case 'Transport': return 'üöö';
                case 'Harvesting': return 'üåæ';
                default: return 'üîß';
            }
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'short', 
                day: 'numeric' 
            });
        }

        function markCompleted(bookingId) {
            const booking = bookingsData.find(b => b.id === bookingId);
            if (booking) {
                booking.status = 'completed';
                loadDashboard();
                
                // Show success message
                const successMsg = document.createElement('div');
                successMsg.className = 'success-message';
                successMsg.textContent = 'Service marked as completed!';
                document.body.appendChild(successMsg);
                
                setTimeout(() => {
                    document.body.removeChild(successMsg);
                }, 3000);
            }
        }

        function refreshBookings() {
            // In real app, this would fetch fresh data from server
            const refreshBtn = event.target;
            refreshBtn.textContent = 'üîÑ Refreshing...';
            refreshBtn.disabled = true;
            
            setTimeout(() => {
                loadDashboard();
                refreshBtn.textContent = 'üîÑ Refresh';
                refreshBtn.disabled = false;
            }, 1000);
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            showPage('loginPage');
        });
    </script>
</body>
</html>
